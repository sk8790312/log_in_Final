<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ™ºèƒ½åŠ©æ•™ç³»ç»Ÿ - çŸ¥è¯†å›¾è°±ç”Ÿæˆä¸å­¦ä¹ å¹³å°</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <header class="header">
    <div class="container">
      <div class="logo">
        <i class="fa fa-graduation-cap"></i>
        <h1>æ™ºèƒ½åŠ©æ•™ç³»ç»Ÿ</h1>
        <p class="subtitle">AIé©±åŠ¨çš„çŸ¥è¯†ç®¡ç†ä¸å­¦ä¹ è¾…åŠ©å¹³å°</p>
      </div>
      <nav class="header-nav">
        <ul>
          <li><a href="#features">äº§å“åŠŸèƒ½</a></li>
          <li><a href="#how-it-works">ä½¿ç”¨æŒ‡å—</a></li>
          <li><a href="#faq">å¸¸è§é—®é¢˜</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="main">
    <section class="hero">
      <div class="container">
        <h2>æ™ºèƒ½çŸ¥è¯†å›¾è°±ç”Ÿæˆç³»ç»Ÿ</h2>
        <p>ä¸Šä¼ å­¦ä¹ èµ„æ–™ï¼Œè‡ªåŠ¨ç”ŸæˆçŸ¥è¯†å›¾è°±ï¼Œæå‡å­¦ä¹ æ•ˆç‡</p>
        <div class="hero-features">
          <div class="feature-card">
            <i class="fa fa-brain fa-2x"></i>
            <h3>AIè¯­ä¹‰åˆ†æ</h3>
            <p>åŸºäºè‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯ï¼Œè‡ªåŠ¨æå–æ–‡æ¡£ä¸­çš„å…³é”®çŸ¥è¯†ç‚¹</p>
          </div>
          <div class="feature-card">
            <i class="fa fa-sitemap fa-2x"></i>
            <h3>å¯è§†åŒ–çŸ¥è¯†ç½‘ç»œ</h3>
            <p>ä»¥å›¾è°±å½¢å¼å±•ç¤ºçŸ¥è¯†ç‚¹å…³è”ï¼Œç›´è§‚å‘ˆç°çŸ¥è¯†ç»“æ„</p>
          </div>
          <div class="feature-card">
            <i class="fa fa-graduation-cap fa-2x"></i>
            <h3>æ™ºèƒ½å­¦ä¹ è·¯å¾„</h3>
            <p>æ ¹æ®å›¾è°±æ¨èå­¦ä¹ é¡ºåºï¼Œä¼˜åŒ–çŸ¥è¯†æŒæ¡æ•ˆç‡</p>
          </div>
        </div>
      </div>
    </section>

    <section id="features" class="features-section">
      <div class="container">
        <h2 class="section-title">æ ¸å¿ƒåŠŸèƒ½</h2>
        <div class="feature-grid">
          <div class="feature-item">
            <div class="feature-icon">
              <i class="fa fa-file-archive fa-3x"></i>
            </div>
            <h3>å¤šæ ¼å¼æ–‡æ¡£æ”¯æŒ</h3>
            <p>æ”¯æŒPPTã€PDFã€Wordã€TXTç­‰å¸¸è§æ–‡æ¡£æ ¼å¼ï¼Œä¸€é”®ä¸Šä¼ è‡ªåŠ¨è§£æ</p>
            <ul class="feature-list">
              <li>â€¢ æ™ºèƒ½è¯†åˆ«æ–‡æ¡£ç« èŠ‚ç»“æ„</li>
              <li>â€¢ è‡ªåŠ¨è¿‡æ»¤æ— å…³å†…å®¹</li>
              <li>â€¢ ä¿ç•™æ–‡æ¡£åŸå§‹æ’ç‰ˆä¿¡æ¯</li>
            </ul>
          </div>
          
          <div class="feature-item">
            <div class="feature-icon">
              <i class="fa fa-project-diagram fa-3x"></i>
            </div>
            <h3>åŠ¨æ€çŸ¥è¯†å›¾è°±ç”Ÿæˆ</h3>
            <p>åŸºäºæ–‡æ¡£å†…å®¹ç”ŸæˆèŠ‚ç‚¹ä¸å…³è”è¾¹ï¼Œæ”¯æŒè‡ªå®šä¹‰èŠ‚ç‚¹æ•°é‡</p>
            <ul class="feature-list">
              <li>â€¢ èŠ‚ç‚¹é‡è¦æ€§æ™ºèƒ½æ’åº</li>
              <li>â€¢ å…³è”å¼ºåº¦å¯è§†åŒ–å±•ç¤º</li>
              <li>â€¢ æ”¯æŒèŠ‚ç‚¹å±‚çº§å±•å¼€/æŠ˜å </li>
            </ul>
          </div>
          
          <div class="feature-item">
            <div class="feature-icon">
              <i class="fa fa-question-circle fa-3x"></i>
            </div>
            <h3>æ™ºèƒ½é—®ç­”ç³»ç»Ÿ</h3>
            <p>åŸºäºçŸ¥è¯†å›¾è°±ç”Ÿæˆç›¸å…³é—®é¢˜ï¼Œæ”¯æŒçŸ¥è¯†ç‚¹ä¸“é¡¹æµ‹è¯•</p>
            <ul class="feature-list">
              <li>â€¢ é—®é¢˜éš¾åº¦è‡ªé€‚åº”è°ƒèŠ‚</li>
              <li>â€¢ å®æ—¶ç­”æ¡ˆåé¦ˆä¸è§£æ</li>
              <li>â€¢ å­¦ä¹ è–„å¼±ç‚¹æ™ºèƒ½æ ‡è®°</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <section class="upload-section">
      <div class="container">
        <h2 class="section-title">ä¸Šä¼ å­¦ä¹ èµ„æ–™</h2>
        <p class="section-desc">ç³»ç»Ÿå°†è‡ªåŠ¨åˆ†ææ–‡æ¡£å†…å®¹å¹¶ç”ŸæˆçŸ¥è¯†å›¾è°±ï¼Œæ”¯æŒPPTã€PDFã€Wordã€TXTæ ¼å¼</p>
        
        <div class="upload-area">
          <i class="fa fa-cloud-upload fa-4x"></i>
          <h3>ä¸Šä¼ å­¦ä¹ èµ„æ–™</h3>
          <p class="upload-tips">
            <i class="fa fa-info-circle"></i> 
            æ¨èä¸Šä¼ å®Œæ•´ç« èŠ‚æ–‡æ¡£ä»¥è·å¾—æ›´å‡†ç¡®çš„çŸ¥è¯†å›¾è°±ï¼Œå•ä¸ªæ–‡ä»¶å»ºè®®ä¸è¶…è¿‡50MB
          </p>
          
          <label for="fileInput" class="file-upload-label">é€‰æ‹©æ–‡ä»¶</label>
          <input type="file" id="fileInput" accept=".docx,.pdf,.pptx" />
          
          <!-- æ–‡ä»¶çŠ¶æ€æç¤ºåŒºåŸŸ -->
          <div id="fileStatus" class="file-status hidden">
            <i class="fa fa-check-circle"></i>
            <span id="fileNameDisplay"></span> å·²å‡†å¤‡å°±ç»ª
            <span class="file-size">æ–‡ä»¶å¤§å°: <span id="fileSize"></span></span>
          </div>
          
          <div class="node-count-input">
            <label for="nodeCountInput">æœŸæœ›èŠ‚ç‚¹æ•°é‡ï¼ˆå¯é€‰ï¼‰:</label>
            <input type="number" id="nodeCountInput" min="0" placeholder="0è¡¨ç¤ºä¸é™åˆ¶">
            <p class="input-tip">èŠ‚ç‚¹æ•°é‡å½±å“å›¾è°±è¯¦ç»†ç¨‹åº¦ï¼Œå»ºè®®è®¾ç½®ä¸º10-50</p>
          </div>
          
          <button id="generateBtn" class="generate-btn">
            <i class="fa fa-cogs"></i>å¼€å§‹ç”Ÿæˆ
            <div class="btn-tooltip">ç‚¹å‡»åç³»ç»Ÿå°†åˆ†ææ–‡æ¡£å¹¶ç”ŸæˆçŸ¥è¯†å›¾è°±</div>
          </button>
        </div>

        <div id="progressContainer" class="hidden">
          <div class="progress-card">
            <div class="progress-header">
              <h3>æ­£åœ¨å¤„ç†æ–‡æ¡£</h3>
              <span id="progressPercentage">0%</span>
            </div>
            <div class="progress-bar">
              <div id="progressBar"></div>
            </div>
            <div class="progress-message">
              <i class="fa fa-spinner fa-spin"></i>
              <p id="progressMessage">å‡†å¤‡å¤„ç†æ–‡æ¡£...
                <span class="processing-step hidden">1/5 æ–‡æ¡£è§£æä¸­</span>
                <span class="processing-step hidden">2/5 çŸ¥è¯†ç‚¹æå–</span>
                <span class="processing-step hidden">3/5 å…³è”å…³ç³»åˆ†æ</span>
                <span class="processing-step hidden">4/5 å›¾è°±ç»“æ„æ„å»º</span>
                <span class="processing-step hidden">5/5 å¯è§†åŒ–æ¸²æŸ“</span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="graph-section">
      <div id="graphContainer" class="hidden">
        <div class="graph-header">
          <h3>çŸ¥è¯†å›¾è°±</h3>
          <div class="graph-info">
            <div class="graph-stats">
            </div>
            <div class="graph-controls">
              <!-- æœç´¢æ¡† -->
              <div class="search-box">
                <i class="fa fa-search"></i>
                <input type="text" id="searchNode" placeholder="æœç´¢çŸ¥è¯†ç‚¹...">
              </div>
              
              <!-- èŠ‚ç‚¹ç­›é€‰ -->
              <div class="filter-group">
                <label>æŒæ¡ç¨‹åº¦:</label>
                <div class="filter-buttons">
                  <button class="filter-btn active" data-status="all">å…¨éƒ¨</button>
                  <button class="filter-btn" data-status="mastered">å·²æŒæ¡</button>
                  <button class="filter-btn" data-status="partial">éƒ¨åˆ†æŒæ¡</button>
                  <button class="filter-btn" data-status="unmastered">æœªæŒæ¡</button>
                </div>
              </div>
              
              
              <!-- èŠ‚ç‚¹æ•°é‡è®¾ç½® -->
              <div class="node-count-input">
                <label for="graphNodeCountInput">èŠ‚ç‚¹æ•°é‡:</label>
                <input type="number" id="graphNodeCountInput" min="0" placeholder="0è¡¨ç¤ºä¸é™åˆ¶">
                <div class="input-tip">è°ƒæ•´èŠ‚ç‚¹æ•°é‡å¯æ”¹å˜å›¾è°±è¯¦ç»†ç¨‹åº¦</div>
              </div>
              
              <!-- é‡æ–°ç”ŸæˆæŒ‰é’® -->
              <button id="regenerateBtn" class="action-btn">
                <i class="fa fa-refresh"></i> é‡æ–°ç”Ÿæˆ
                <div class="btn-tooltip">ä½¿ç”¨å½“å‰è®¾ç½®é‡æ–°ç”ŸæˆçŸ¥è¯†å›¾è°±</div>
              </button>
            </div>
          </div>
        </div>

        <div id="networkContainer"></div>

        <div class="graph-footer">
          <div class="legend">
            <h4>å›¾ä¾‹è¯´æ˜</h4>
            <div class="legend-items">
              <div class="legend-item">
                <div class="color mastered"></div>
                <span>å·²æŒæ¡ <span class="example-node"></span></span>
              </div>
              <div class="legend-item">
                <div class="color partial"></div>
                <span>éƒ¨åˆ†æŒæ¡ <span class="example-node"></span></span>
              </div>
              <div class="legend-item">
                <div class="color unmastered"></div>
                <span>æœªæŒæ¡ <span class="example-node"></span></span>
              </div>
            </div>
          </div>
          <div class="stats">
            <span>èŠ‚ç‚¹: <span id="nodeCount">0</span></span>
            <span>è¾¹: <span id="edgeCount">0</span></span>
            <span>å…³é”®èŠ‚ç‚¹: <span id="keyNodes">0</span></span>
          </div>
        </div>
      </div>
    </section>

    

    <section class="quiz-section">
      <div id="quizContainer" class="hidden">
        <div class="quiz-header">
          <h3>çŸ¥è¯†æµ‹è¯•</h3>
          <div class="quiz-meta">
            <span>å½“å‰çŸ¥è¯†ç‚¹: <span id="currentTopic">æš‚æ— </span></span>
            <span>æµ‹è¯•è¿›åº¦: <span id="quizProgress">0/0</span></span>
          </div>
        </div>
        <div class="quiz-body">
          <!-- æ–°å¢ï¼šé—®é¢˜ç”Ÿæˆæç¤ºå®¹å™¨ -->
          <div id="questionGenerating" class="hidden">
            <div class="notification">
              <i class="fa fa-spinner fa-spin"></i>
              <span>é—®é¢˜æ­£åœ¨ç”Ÿæˆä¸­ï¼Œè¯·ç¨å€™... (AIåˆ†æçŸ¥è¯†ç‚¹å…³è”æ€§ä¸­)</span>
            </div>
          </div>
          
          <!-- å†å²å¯¹è¯åŒºåŸŸ -->
          <div id="chatHistory" class="chat-history">
            <h4>æµ‹è¯•å†å²</h4>
            <div class="history-empty hidden">
              <i class="fa fa-history"></i>
              <p>æš‚æ— æµ‹è¯•è®°å½•ï¼Œç‚¹å‡»å›¾è°±èŠ‚ç‚¹å¼€å§‹æµ‹è¯•</p>
            </div>
            <div class="history-list"></div>
          </div>
          
          <div id="questionCard" class="hidden">
            <div class="question-card">
              <div class="question-header">
                <i class="fa fa-question-circle"></i>
                <h4>é—®é¢˜ <span id="questionNumber">1</span></h4>
              </div>
              <div class="question-body">
                <p id="currentQuestion">è¯·æè¿°è®¡ç®—æœºç½‘ç»œä¸­OSIä¸ƒå±‚æ¨¡å‹çš„ä¸»è¦åŠŸèƒ½åˆ’åˆ†ã€‚</p>
                <div class="question-hint hidden">
                  <i class="fa fa-lightbulb"></i>
                  <p>æç¤ºï¼šè¯¥æ¨¡å‹ä»ä¸‹è‡³ä¸Šåˆ†åˆ«ä¸ºç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚...æ¯ä¸€å±‚è´Ÿè´£ä¸åŒçš„ç½‘ç»œåŠŸèƒ½</p>
                </div>
              </div>
              
              <div class="answer-area">
                <h4>ä½ çš„å›ç­”</h4>
                <textarea id="userAnswer" placeholder="è¯·è¾“å…¥ä½ çš„å›ç­”..."></textarea>
                <div class="answer-tips">
                  <i class="fa fa-info-circle"></i>
                  <p>å›ç­”è¶Šè¯¦ç»†è¶Šæœ‰åŠ©äºç³»ç»Ÿè¯„ä¼°æŒæ¡ç¨‹åº¦ï¼Œå»ºè®®ä½¿ç”¨ä¸“ä¸šæœ¯è¯­</p>
                </div>
                <button id="submitAnswer" class="generate-btn">
                  <span id="submitText">æäº¤ç­”æ¡ˆ</span>
                </button>
              </div>
            </div>
          </div>
          
          <div id="answerFeedback" class="feedback-card hidden">
            <div class="feedback-header">
              <i class="fa fa-check-circle"></i>
              <h4 id="feedbackTitle">å›ç­”æ­£ç¡®</h4>
            </div>
            <div class="feedback-body">
              <p id="feedbackText">ä½ çš„å›ç­”å‡†ç¡®è¦†ç›–äº†OSIä¸ƒå±‚æ¨¡å‹çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯å¯¹ç½‘ç»œå±‚å’Œä¼ è¾“å±‚çš„åŒºåˆ†æè¿°æ¸…æ™°ã€‚</p>
              <div class="feedback-explanation">
                <h5>è¯¦ç»†è§£æ</h5>
                <p>OSIä¸ƒå±‚æ¨¡å‹ä»ä¸‹è‡³ä¸Šåˆ†åˆ«ä¸ºï¼šç‰©ç†å±‚ï¼ˆä¼ è¾“æ¯”ç‰¹æµï¼‰ã€æ•°æ®é“¾è·¯å±‚ï¼ˆå¸§ä¼ è¾“ä¸é”™è¯¯æ£€æµ‹ï¼‰ã€ç½‘ç»œå±‚ï¼ˆè·¯ç”±ä¸å¯»å€ï¼‰...ï¼ˆå®Œæ•´è§£æå†…å®¹ï¼‰</p>
              </div>
            </div>
            <div class="feedback-actions">
              <button id="nextQuestion" class="action-btn">ä¸‹ä¸€ä¸ªé—®é¢˜</button>
              <button id="markMastered" class="action-btn">æ ‡è®°ä¸ºå·²æŒæ¡</button>
            </div>
          </div>
          
          <div id="noQuestion">
            <i class="fa fa-question-circle fa-4x"></i>
            <h4>è¯·å…ˆé€‰æ‹©ä¸€ä¸ªçŸ¥è¯†ç‚¹</h4>
            <p>åœ¨çŸ¥è¯†å›¾è°±ä¸­ç‚¹å‡»ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¼€å§‹é’ˆå¯¹è¯¥çŸ¥è¯†ç‚¹çš„ä¸“é¡¹æµ‹è¯•</p>
            <p class="hint-text">æç¤ºï¼šèŠ‚ç‚¹è¶Šå¤§è¡¨ç¤ºåœ¨æ–‡æ¡£ä¸­é‡è¦æ€§è¶Šé«˜ï¼Œç‚¹å‡»å…³é”®èŠ‚ç‚¹å¯è·å¾—æ›´å¤šç›¸å…³é—®é¢˜</p>
          </div>
        </div>
      </div>
    </section>
    <section class="chat-section">
  <div class="container">
    <h2 class="section-title">æ™ºèƒ½åŠ©æ‰‹</h2>
    <div class="chat-box">
      <div class="chat-history" id="qaHistory"></div>
      <div class="chat-input">
        <textarea id="qaInput" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜ï¼Œå¦‚ï¼šå›¾ç¥ç»ç½‘ç»œçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Ÿ"></textarea>
        <button id="qaSubmitBtn">å‘é€</button>
      </div>
      <div class="chat-feedback" id="resourceRecommend"></div>
    </div>
  </div>
</section>
<script>
  const qaSubmitBtn = document.getElementById('qaSubmitBtn');
  const qaInput = document.getElementById('qaInput');
  const qaHistory = document.getElementById('qaHistory');
  const resourceRecommend = document.getElementById('resourceRecommend');

  // æ–°å¢ï¼šæ€è€ƒä¸­æç¤ºå…ƒç´ 
  let thinkingMsg = null;

  // æ–°å¢ï¼šæ¬¢è¿å¼•å¯¼è¯­
  qaInput.addEventListener('focus', () => {
    if (!qaHistory.innerHTML.trim()) {
      const welcomeMsg = `<div class='msg ai-msg welcome-msg'>
        <strong>æ‚¨å¥½ï¼æˆ‘æ˜¯é™¢æ ¡æ™ºèƒ½åŠ©æ‰‹</strong>ï¼Œå¯ä»¥ä¸ºæ‚¨è§£ç­”å…³äºå­¦æ ¡ã€ä¸“ä¸šã€æ‹›ç”Ÿç­‰æ–¹é¢çš„é—®é¢˜ã€‚<br>
        æ‚¨å¯ä»¥ï¼š<br>
        <span class='dot'>â€¢</span> ç‚¹å‡»ä¸Šæ–¹çŸ¥è¯†å›¾è°±æ¢ç´¢æ„Ÿå…´è¶£çš„ä¸»é¢˜<br>
        <span class='dot'>â€¢</span> ç›´æ¥æé—®æ‚¨å…³å¿ƒçš„é—®é¢˜<br>
        <span class='dot'>â€¢</span> æŸ¥çœ‹ä¸‹æ–¹æ¨èçš„çƒ­é—¨è¯é¢˜
      </div>`;
      qaHistory.innerHTML = welcomeMsg;
    }
  });

  qaSubmitBtn.addEventListener('click', () => {
    const question = qaInput.value.trim();
    if (!question) return;
    // æ˜¾ç¤ºç”¨æˆ·é—®é¢˜ï¼ˆå»é™¤é¦–è¡Œç©ºè¡Œï¼‰
    const userMsg = `<div class='msg user-msg'><strong>ä½ ï¼š</strong> ${question}</div>`;
    qaHistory.innerHTML += userMsg;
    qaInput.value = '';
    // æ˜¾ç¤ºâ€œæ­£åœ¨æ€è€ƒä¸­â€¦â€¦â€
    thinkingMsg = document.createElement('div');
    thinkingMsg.className = 'msg thinking-msg';
    thinkingMsg.innerHTML = `<i class="fa fa-spinner fa-spin"></i> æ­£åœ¨æ€è€ƒä¸­â€¦â€¦`;
    qaHistory.appendChild(thinkingMsg);
    qaHistory.scrollTop = qaHistory.scrollHeight;
    // åˆ¤æ–­æ˜¯å¦ä¸Šä¼ æ–‡æ¡£
    const requestData = {
        question: question,
        topology_id: currentTopologyId || '',  // è‹¥æ— åˆ™ä¸º ""
    };

    fetch('/api/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(requestData)
    })
    .then(res => res.json())
    .then(data => {
      // éšè—â€œæ­£åœ¨æ€è€ƒä¸­â€¦â€¦â€
      if (thinkingMsg) {
        thinkingMsg.remove();
        thinkingMsg = null;
      }
      if (data.status === 'success') {
        // æ˜¾ç¤º AI å›ç­”æ¥æºï¼ˆæ–‡æ¡£ or ç½‘ç»œï¼‰ï¼Œå»é™¤é¦–è¡Œç©ºè¡Œ
        const aiMsg = `<div class='msg ai-msg'><strong>æ™ºèƒ½åŠ©æ‰‹ï¼ˆæ¥è‡ª${data.source === 'document' ? 'æ–‡æ¡£' : 'ç½‘ç»œ'}ï¼‰ï¼š</strong> ${data.answer}</div>`;
        qaHistory.innerHTML += aiMsg;

        if (data.resources && data.resources.length > 0) {
          let links = `<div class="resource-list"><h4>ğŸ“š æ¨èå­¦ä¹ èµ„æºï¼š</h4><ul>`;
          for (const res of data.resources) {
            links += `<li><a href='${res.url}' target='_blank'>${res.title}</a> - ${res.snippet}</li>`;
          }
          links += `</ul></div>`;
          resourceRecommend.innerHTML = links;
        } else {
          resourceRecommend.innerHTML = '';
        }
      } else {
        qaHistory.innerHTML += `<div class='msg error-msg'>âš ï¸ å‡ºé”™ï¼š${data.message}</div>`;
      }
    });
  });
</script>
<style>
  .chat-box {
    background: #f8fafc;
    border-radius: 14px;
    box-shadow: 0 2px 12px rgba(52,152,219,0.08);
    padding: 32px 32px 20px 32px;
    margin-bottom: 32px;
    max-width: 900px;
    margin-left: auto;
    margin-right: auto;
  }
  .chat-history {
    min-height: 120px;
    max-height: 500px;
    overflow-y: auto;
    padding-bottom: 12px;
  }
  .msg {
    margin: 18px 0 10px 0;
    padding: 12px 18px 16px 18px; /* ä¸Šå†…è¾¹è·å‡å°ï¼Œå»é™¤é¦–è¡Œç©ºç™½ */
    border-radius: 10px;
    font-size: 16px;
    line-height: 1.8;
    word-break: break-all;
    white-space: pre-line;
    box-shadow: 0 1px 4px rgba(52,152,219,0.04);
    transition: background 0.2s;
  }
  .user-msg {
    background: #f3f4f6;
    color: #222;
    border-left: 5px solid #3498db;
    font-weight: 500;
    font-size: 16px;
  }
  .ai-msg {
    background: #eaf6ff;
    color: #1a355b;
    border-left: 5px solid #2ecc71;
    font-weight: 500;
    position: relative;
    font-size: 16px;
  }
  .ai-msg strong {
    color: #2176ae;
    font-weight: bold;
    font-size: 17px;
  }
  .ai-msg em, .user-msg em {
    color: #e67e22;
    font-style: normal;
    font-weight: bold;
    background: #fffbe6;
    padding: 0 4px;
    border-radius: 3px;
  }
  .ai-msg code, .user-msg code {
    background: #f4f4f4;
    color: #c7254e;
    font-family: 'Fira Mono', 'Consolas', monospace;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 15px;
  }
  .ai-msg pre, .user-msg pre {
    background: #f4f4f4;
    color: #333;
    font-family: 'Fira Mono', 'Consolas', monospace;
    padding: 12px;
    border-radius: 6px;
    margin: 10px 0;
    font-size: 15px;
    overflow-x: auto;
  }
  .ai-msg blockquote, .user-msg blockquote {
    background: #f0f7ff;
    border-left: 4px solid #3498db;
    margin: 10px 0;
    padding: 10px 16px;
    color: #555;
    border-radius: 6px;
    font-style: italic;
    font-size: 15px;
  }
  .thinking-msg {
    color: #888;
    font-style: italic;
    margin: 10px 0;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 15px;
    background: #f8fafc;
    border-left: 4px solid #95a5a6;
    padding: 10px 14px;
    border-radius: 8px;
  }
  .thinking-msg i {
    color: #3498db;
    margin-right: 6px;
  }
  .resource-list {
    background: #f6fafd;
    border-radius: 8px;
    padding: 14px 18px 10px 18px;
    margin: 18px 0 0 0;
    box-shadow: 0 1px 4px rgba(52,152,219,0.04);
  }
  .resource-list h4 {
    color: #2176ae;
    font-size: 16px;
    margin-bottom: 10px;
    font-weight: bold;
  }
  .resource-list ul {
    padding-left: 18px;
    margin: 0;
  }
  .resource-list li {
    margin-bottom: 7px;
    font-size: 15px;
    line-height: 1.7;
    color: #1a355b;
  }
  .resource-list a {
    color: #2980b9;
    text-decoration: underline;
    font-weight: 500;
    margin-right: 4px;
  }
  .resource-list a:hover {
    color: #e67e22;
  }
  .error-msg {
    background: #fff0f0;
    color: #e74c3c;
    border-left: 5px solid #e74c3c;
    font-size: 15px;
    padding: 12px 16px;
    border-radius: 8px;
    margin: 12px 0;
  }
  .upload-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 18px;
    margin-bottom: 32px;
    font-size: 17px;
  }
  .file-upload-label {
    display: inline-block;
    padding: 12px 38px;
    border-radius: 28px;
    background: linear-gradient(90deg, #3498db 60%, #6dd5fa 100%);
    color: #fff;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(52,152,219,0.10);
    margin: 0 auto;
    transition: background 0.2s;
    text-align: center;
  }
  .file-upload-label:hover {
    background: linear-gradient(90deg, #217dbb 60%, #4fc3f7 100%);
    color: #fff;
  }
  .upload-section input[type="file"] {
    display: none;
  }
  .upload-section input[type="file"]::-webkit-file-upload-button {
    font-size: 17px;
    border-radius: 24px;
    background: linear-gradient(90deg, #e0e3e7 60%, #f5f6fa 100%);
    color: #222;
    border: none;
    padding: 8px 24px;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.2s;
  }
  .upload-section input[type="file"]::-webkit-file-upload-button:hover {
    background: linear-gradient(90deg, #bfc2c7 60%, #e0e3e7 100%);
  }
  .upload-section select, .upload-section input[type="text"] {
    font-size: 16px;
    padding: 6px 12px;
    border-radius: 6px;
    border: 1px solid #d0d7de;
    background: #f8fafc;
    margin-bottom: 0;
    display: block;
    margin-left: auto;
    margin-right: auto;
    text-align: center;
  }
  .upload-section button {
    font-size: 19px;
    font-weight: 600;
    padding: 10px 32px;
    border-radius: 8px;
    background: linear-gradient(90deg, #a18cd1 60%, #fbc2eb 100%);
    color: #fff;
    border: none;
    box-shadow: 0 2px 8px rgba(52,152,219,0.10);
    cursor: pointer;
    margin: 18px auto 0 auto;
    display: block;
    transition: background 0.2s, transform 0.1s;
    text-align: center;
  }
  .upload-section button:hover {
    background: linear-gradient(90deg, #7b5fa7 60%, #a18cd1 100%);
    color: #fff;
    transform: translateY(-2px) scale(1.04);
  }
  .welcome-msg {
    background: linear-gradient(90deg, #e3f0fc 60%, #f6fbff 100%);
    color: #2563a6;
    border-left: 5px solid #3498db;
    font-size: 16px;
    font-weight: 500;
    margin-top: 10px;
    margin-bottom: 10px;
    box-shadow: 0 1px 4px rgba(52,152,219,0.04);
    line-height: 1.5;
  }
  .welcome-msg .dot {
    color: #3498db;
    font-size: 18px;
    margin-right: 4px;
  }
</style>

  </main>

  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-info">
          <h3>æ™ºèƒ½åŠ©æ•™ç³»ç»Ÿ</h3>
          <p>AIé©±åŠ¨çš„çŸ¥è¯†ç®¡ç†å¹³å°ï¼Œå¸®åŠ©ç”¨æˆ·é«˜æ•ˆå­¦ä¹ ä¸çŸ¥è¯†æ¢³ç†</p>
          <div class="social-links">
            <a href="#"><i class="fa fa-weixin"></i></a>
            <a href="#"><i class="fa fa-weibo"></i></a>
            <a href="#"><i class="fa fa-github"></i></a>
          </div>
        </div>
        
        <div class="footer-links">
          <h4>å¿«é€Ÿé“¾æ¥</h4>
          <ul>
            <li><a href="#features">äº§å“åŠŸèƒ½</a></li>
            <li><a href="#how-it-works">ä½¿ç”¨æŒ‡å—</a></li>
            <li><a href="#faq">å¸¸è§é—®é¢˜</a></li>
            <li><a href="#">æ›´æ–°æ—¥å¿—</a></li>
          </ul>
        </div>
        
        <div class="footer-links">
          <h4>æ”¯æŒä¸­å¿ƒ</h4>
          <ul>
            <li><a href="#">å¸®åŠ©æ–‡æ¡£</a></li>
            <li><a href="#">è”ç³»æˆ‘ä»¬</a></li>
            <li><a href="#">éšç§æ”¿ç­–</a></li>
            <li><a href="#">æœåŠ¡æ¡æ¬¾</a></li>
          </ul>
        </div>
      </div>
      <p>Â© 2025 æ™ºèƒ½åŠ©æ•™ç³»ç»Ÿ | çŸ¥è¯†å›¾è°±å­¦ä¹ å¹³å° | æŠ€æœ¯æ”¯æŒï¼šAIçŸ¥è¯†å·¥ç¨‹å®éªŒå®¤</p>
    </div>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
  
  <div id="contextModal" class="context-modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">åŸæ–‡ä¸Šä¸‹æ–‡</h3>
        <button id="closeContextModal" class="close-modal">&times;</button>
      </div>
      <div class="modal-body" id="contextContent">
        <div class="context-loading">
          <i class="fa fa-spinner fa-spin"></i>
          <p>åŠ è½½åŸæ–‡ä¸Šä¸‹æ–‡... (è¯¥åŠŸèƒ½éœ€æ–‡æ¡£è§£æå®Œæˆåå¯ç”¨)</p>
        </div>
      </div>
    </div>
  </div>

  <div id="nodeActionModal" class="modal-dialog hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">èŠ‚ç‚¹æ“ä½œ</h3>
        <button id="closeNodeActionModal" class="close-modal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="node-info">
          <h4 id="modalNodeName">çŸ¥è¯†ç‚¹åç§°</h4>
          <p id="modalNodeDesc">çŸ¥è¯†ç‚¹æè¿°ä¿¡æ¯å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</p>
        </div>
        <p>è¯·é€‰æ‹©æ“ä½œï¼š</p>
        <div class="action-buttons">
          <button id="startQuizBtn" class="action-btn">
            <i class="fa fa-question-circle"></i> è¿›å…¥é—®ç­”æ¨¡å¼
          </button>
          <button id="markNodeBtn" class="action-btn">
            <i class="fa fa-clipboard-check"></i> æ ‡è®°æŒæ¡çŠ¶æ€
          </button>
          <button id="deleteNodeBtn" class="action-btn danger">
            <i class="fa fa-trash"></i> åˆ é™¤èŠ‚ç‚¹
          </button>
        </div>
      </div>
    </div>
  </div>
</body>
</html>